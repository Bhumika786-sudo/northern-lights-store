<div class="col-md-3">
  <div class="card h-100 shadow-sm">

    <!-- IMAGE AREA -->
    <div class="d-flex align-items-center justify-content-center bg-light" style="height: 260px;">
      <% if product.image.attached? %>
        <!-- Show ActiveStorage image directly -->
        <%= image_tag product.image, class: "img-fluid" %>
      <% elsif product.respond_to?(:image_url) && product.image_url.present? %>
        <!-- Fallback to old image_url column if you used it in seeds -->
        <%= image_tag product.image_url, class: "img-fluid" %>
      <% else %>
        <span class="text-muted">No Image</span>
      <% end %>
    </div>

    <!-- CARD BODY -->
    <div class="card-body d-flex flex-column">
      <h5 class="card-title">
        <%= link_to product.name, product_path(product), class: "text-decoration-none" %>
      </h5>

      <p class="card-text small text-muted flex-grow-1">
        <%= truncate(product.description, length: 120) %>
      </p>

      <p class="fw-bold mb-2">
        <%= number_to_currency(product.price) %>
      </p>

      <%= button_to "Add to Cart",
                    add_cart_path(product),
                    method: :post,
                    class: "btn btn-primary mt-auto w-100" %>
    </div>

  </div>
</div>
